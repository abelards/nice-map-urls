<%= form_for Place.new do |f| %>
  <%= text_field_tag :address, '', :placeholder => 'search for address...' %>
  <button type="submit">Search</button>
  
  <%= f.hidden_field :path %>
  <%= f.hidden_field :geocode %>
  <%= f.hidden_field :latitude %>
  <%= f.hidden_field :longitude %>
<% end %>

<div id="map">
  
</div>

<script>
  $(function(){
    var view = new SearchView(<%= @place.to_json.html_safe %>)
    
    <% if @path.present? and @place.nil? %>
      // This is vulnerable to html injection...
      view.resolveAndGoto(<%= @path.to_json.html_safe %>);
    <% end %>
  });
</script>